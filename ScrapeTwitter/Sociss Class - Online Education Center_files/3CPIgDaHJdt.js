if (self.CavalryLogger) { CavalryLogger.start_js(["7iKir"]); }

__d("TextInputControl",["DOMControl","Event","Input","debounce"],(function(a,b,c,d,e,f){__p&&__p();var g;c=babelHelpers.inherits(a,b("DOMControl"));g=c&&c.prototype;function a(a){"use strict";g.constructor.call(this,a);a=this.getRoot();var c=b("debounce")(this.update.bind(this),0);b("Event").listen(a,{input:c,keydown:c,paste:c})}a.prototype.setMaxLength=function(a){"use strict";b("Input").setMaxLength(this.getRoot(),a);return this};a.prototype.getValue=function(){"use strict";return b("Input").getValue(this.getRoot())};a.prototype.isEmpty=function(){"use strict";return b("Input").isEmpty(this.getRoot())};a.prototype.setValue=function(a){"use strict";b("Input").setValue(this.getRoot(),a);this.update();return this};a.prototype.clear=function(){"use strict";return this.setValue("")};a.prototype.setPlaceholderText=function(a){"use strict";b("Input").setPlaceholder(this.getRoot(),a);return this};e.exports=a}),null);
__d("transferTextStyles",["Style"],(function(a,b,c,d,e,f){var g={fontFamily:null,fontSize:null,fontStyle:null,fontWeight:null,lineHeight:null,wordWrap:null};function a(a,c){for(var d in g)Object.prototype.hasOwnProperty.call(g,d)&&(g[d]=b("Style").get(a,d));b("Style").apply(c,g)}e.exports=a}),null);
__d("TextMetrics",["DOM","Style","UserAgent","transferTextStyles"],(function(a,b,c,d,e,f){__p&&__p();function g(a){var c=a.clientWidth,d=b("Style").get(a,"-moz-box-sizing")=="border-box";if(d&&b("UserAgent").isBrowser("Firefox < 29"))return c;d=b("Style").getFloat(a,"paddingLeft")+b("Style").getFloat(a,"paddingRight");return c-d}function a(a,c){"use strict";this.$1=a;this.$2=!!c;c="textarea";var d="textMetrics";this.$2&&(c="div",d+=" textMetricsInline");this.$3=b("DOM").create(c,{className:d});b("transferTextStyles")(a,this.$3);document.body.appendChild(this.$3)}a.prototype.measure=function(a){"use strict";var c=this.$1,d=this.$3;a=(a||c.value)+"...";if(!this.$2){var e=g(c);b("Style").set(d,"width",Math.max(e,0)+"px")}c.nodeName==="TEXTAREA"?d.value=a:b("DOM").setContent(d,a);return{width:d.scrollWidth,height:d.scrollHeight}};a.prototype.destroy=function(){"use strict";b("DOM").remove(this.$3)};e.exports=a}),null);
__d("TextAreaControl",["Arbiter","ArbiterMixin","CSS","DOMControl","Event","Style","TextInputControl","TextMetrics","classWithMixins","mixin"],(function(a,b,c,d,e,f){__p&&__p();var g;function h(a,c){return b("Style").getFloat(a,c)||0}a=babelHelpers.inherits(i,b("classWithMixins")(b("TextInputControl"),b("mixin")(b("ArbiterMixin"))));g=a&&a.prototype;function i(a){"use strict";g.constructor.call(this,a),this.autogrow=b("CSS").hasClass(a,"uiTextareaAutogrow"),this.autogrowWithPlaceholder=b("CSS").hasClass(a,"uiTextareaAutogrowWithPlaceholder"),this.width=null,b("Event").listen(a,"focus",this._handleFocus.bind(this))}i.prototype.setAutogrow=function(a){"use strict";this.autogrow=a;return this};i.prototype.onupdate=function(){"use strict";g.onupdate.call(this),this.updateHeight()};i.prototype.updateHeight=function(){"use strict";__p&&__p();if(this.autogrow){var a=this.getRoot();this.metrics||(this.metrics=new(b("TextMetrics"))(a));typeof this.initialHeight==="undefined"&&(this.isBorderBox=b("Style").get(a,"box-sizing")==="border-box"||b("Style").get(a,"-moz-box-sizing")==="border-box"||b("Style").get(a,"-webkit-box-sizing")==="border-box",this.borderBoxOffset=h(a,"padding-top")+h(a,"padding-bottom")+h(a,"border-top-width")+h(a,"border-bottom-width"),this.initialHeight=a.offsetHeight-this.borderBoxOffset);var c;(!a.value||a.value.length===0)&&this.autogrowWithPlaceholder?c=this.metrics.measure(a.placeholder):c=this.metrics.measure();c=Math.max(this.initialHeight,c.height);this.isBorderBox&&(c+=this.borderBoxOffset);this.maxHeight&&c>this.maxHeight&&(c=this.maxHeight,b("Arbiter").inform("maxHeightExceeded",{textArea:a}));c!==this.height&&(this.height=c,b("Style").set(a,"height",c+"px"),b("Arbiter").inform("reflow"),this.inform("resize"))}else this.metrics&&(this.metrics.destroy(),this.metrics=null)};i.prototype.resetHeight=function(){"use strict";this.height=-1,this.update()};i.prototype.setMaxHeight=function(a){"use strict";this.maxHeight=a};i.prototype.setAutogrowWithPlaceholder=function(a){"use strict";this.autogrowWithPlacedholder=a};i.prototype._handleFocus=function(){"use strict";this.width=null};i.getInstance=function(a){"use strict";return b("DOMControl").getInstance(a)||new i(a)};e.exports=i}),null);
__d("PluginConnectButtonType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({BLUE_BASE:1,WHITE_BASE:2})}),null);
__d("PluginFlyout",["csx","Arbiter","Button","CSS","DOM","DOMEvent","DOMEventListener","Focus","FormSubmit","Plugin","TextAreaControl"],(function(a,b,c,d,e,f,g){__p&&__p();var h="new",i=b("Arbiter").subscribe,j=b("Arbiter").inform,k=function(a,c){return b("DOMEventListener").add(a,"click",c)};function l(a,c,d){var e=this,f=i(b("Plugin").CONNECT,function(event,g){b("Arbiter").unsubscribe(f),e.init(a,c,d),e.connect(event,g)},h);i(b("Plugin").DIALOG,function(){e.init(a,c,d),e.toggle()},h)}Object.assign(l.prototype,{init:function(a,c,d){__p&&__p();if(this.initialized)return;this.initialized=!0;b("DOM").appendContent(a,JSON.parse(d));var e=b("DOM").find(a,"form"),f=b("DOM").find(e,"._56zw");d=b("DOM").find(e,"._56zx");var g=b("DOM").find(e,"._42x4"),j=b("TextAreaControl").getInstance(g);b("DOMEventListener").add(g,"keyup",function(a){b("Button").setEnabled(f,!!j.getValue())});b("DOMEventListener").add(window,"keydown",function(a){a.keyCode===27&&n()});b("DOMEventListener").add(e,"submit",function(a){new(b("DOMEvent"))(a).kill(),b("FormSubmit").send(e)});var m=c==="tiny"?b("DOM").find(document.body,".pluginPostFlyoutPrompt"):null;this.flyout=a;this.form=e;this.post_button=f;this.prompt=m;var n=this.hide.bind(this),o=this.show.bind(this);k(d,function(a){new(b("DOMEvent"))(a).kill(),n()});m&&k(m,function(a){new(b("DOMEvent"))(a).kill(),o()});i(b("Plugin").CONNECT,this.connect.bind(this),h);i(b("Plugin").DISCONNECT,function(){n()},h);i(l.SUCCESS,function(){n(),m&&b("CSS").hide(m)},h);i(b("Plugin").ERROR,function(event,a){if(a.action!=="comment")return;b("DOM").setContent(b("DOM").find(e,"._56zy"),a.content);b("CSS").hide(f)},h)},connect:function(event,a){if(a.crossFrame)return;this.prompt&&b("CSS").show(this.prompt);a.story_fbid||this.show()},show:function(){this.shown=!0;b("CSS").show(this.flyout);b("CSS").show(this.post_button);var a=b("DOM").scry(this.form,"._5jjo");a?b("Focus").set(a[0]):b("Focus").set(this.form.comment);j(l.SHOW)},hide:function(){this.shown=!1,b("CSS").hide(this.flyout),j(l.HIDE)},toggle:function(){this.shown?this.hide():this.show()}});Object.assign(l,{SUCCESS:"platform/plugins/flyout/success",SHOW:"platform/plugins/flyout/show",HIDE:"platform/plugins/flyout/hide",success:function(){j(l.SUCCESS)}});e.exports=l}),null);
__d("PluginConnectButton",["Arbiter","CSS","DOM","DOMEvent","DOMEventListener","Focus","FormSubmit","PlatformWidgetEndpoint","Plugin","PluginConnectButtonType","PluginFlyout","PluginOptin","URI"],(function(a,b,c,d,e,f){__p&&__p();var g="new",h=b("Arbiter").subscribe,i=function(a,c){return b("DOMEventListener").add(a,"click",c)};function a(a){__p&&__p();this.config=a;this.busy=!1;var c=b("DOM").find(a.form,".pluginConnectButton");this.buttons=c;this.node_connected=b("DOM").find(c,".pluginConnectButtonConnected");this.node_disconnected=b("DOM").find(c,".pluginConnectButtonDisconnected");var d=function(a){new(b("DOMEvent"))(a).kill(),this.busy||(this.submit(),this.busy=this.canpersonalize)}.bind(this);i(this.node_disconnected,d);a.buttontype===b("PluginConnectButtonType").BLUE_BASE?i(b("DOM").find(c,".pluginButtonX button"),d):a.buttontype===b("PluginConnectButtonType").WHITE_BASE&&i(this.node_connected,d);i(this.node_connected,function(a){return b("Arbiter").inform(b("Plugin").DIALOG,a)});c=this.update.bind(this);h(b("Plugin").CONNECT,c,g);h(b("Plugin").DISCONNECT,c,g);h(b("Plugin").ERROR,this.error.bind(this),g);h(b("PluginFlyout").HIDE,this.hideFlyout.bind(this));a.autosubmit&&setTimeout(this.submit.bind(this),0)}Object.assign(a.prototype,{update:function(a,event){__p&&__p();this.busy=!1;var c=this.config;if(event.identifier!==c.identifier)return;a=a===b("Plugin").CONNECT;var d=b("PlatformWidgetEndpoint").plugins(c.plugin);d+="/"+(a?"disconnect":"connect");b("CSS")[a?"show":"hide"](this.node_connected);b("CSS")[a?"hide":"show"](this.node_disconnected);try{if(document.activeElement.nodeName.toLowerCase()==="button"){var e=a?this.node_connected:this.node_disconnected;e=b("DOM").find(e,"button");e.disabled=!1;b("Focus").set(e)}}catch(a){}c.connected=a;c.form.setAttribute("action",d);c.form.setAttribute("ajaxify",d)},error:function(event,a){this.busy=!1;if(a.action in{connect:1,disconnect:1}){b("DOM").setContent(this.buttons,a.content);a=b("DOM").scry(this.buttons,".confirmButton");a.length===1&&b("Focus").set(a[0])}},submit:function(){if(!this.config.canpersonalize)return this.login();b("FormSubmit").send(this.config.form);this.fireStateToggle()},fireStateToggle:function(){var a=this.config;a.connected?b("Plugin").disconnect(a.identifier):b("Plugin").connect(a.identifier)},login:function(){var a=this.config.plugin;new(b("PluginOptin"))(a,b("URI").getRequestURI().getQueryData().api_key).addReturnParams({act:"connect"}).addLoginParams({social_plugin_action:this.config.pluginaction,kid_directed_site:this.config.kidDirectedSite}).start()},hideFlyout:function(){b("Focus").set(this.connected?this.node_disconnected:this.node_connected)}});e.exports=a}),null);